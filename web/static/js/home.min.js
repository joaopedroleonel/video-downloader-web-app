function resetIu(){document.getElementById("download-btn").removeAttribute("disabled"),document.getElementById("url").value="",document.getElementById("playlist").checked=!1}document.getElementById("url").addEventListener("input",function(e){e.target.value.toLowerCase().includes("playlist")?document.getElementById("playlist").checked=!0:document.getElementById("playlist").checked=!1}),document.getElementById("form").addEventListener("submit",async function(e){e.preventDefault(),document.getElementById("status").textContent="";var e=document.getElementById("url").value,t=document.getElementById("playlist").checked,o=document.querySelector('input[name="format"]:checked').value,t={playlist:t,type:Number(o),url:e};if(e)try{document.getElementById("download-btn").setAttribute("disabled","");const statusElement=document.getElementById("status");statusElement.textContent="Conectando ao servidor.";var n=await fetch("/initDownload",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)});if(n.ok){var d=await n.json();if(d&&d.uuid){const a=io(),l=d.uuid;a.emit("checkStatus",{jobId:l}),a.on("statusUpdate",e=>{var t;e.status?(statusElement.textContent=e.msg,"finally"===e.status&&((t=document.createElement("a")).href="/download/"+l,t.download="",t.click(),resetIu(),a.disconnect()),"error"===e.status&&(document.getElementById("download-btn").removeAttribute("disabled"),a.disconnect())):e.error&&(statusElement.textContent="Não foi possível realizar o download do vídeo.",document.getElementById("download-btn").removeAttribute("disabled"),a.disconnect())})}}else"401"==n.status?window.location.reload():(statusElement.textContent="Não foi possível realizar o download do vídeo.",document.getElementById("download-btn").removeAttribute("disabled"))}catch(e){statusElement.textContent="Não foi possível realizar o download do vídeo.",document.getElementById("download-btn").removeAttribute("disabled")}});